### 27
接続可能な機器:
USB0::6833::1100::DHO9A270600106::0::INSTR
接続した機器: USBInstrument at USB0::6833::1100::DHO9A270600106::0::INSTR
機器ID: RIGOL TECHNOLOGIES,DHO914,DHO9A270600106,00.01.03

測定完了確認: 0

データ点数: 1000
取得したデータ長: 1000
最初の10個のデータ: [86, 86, 86, 87, 86, 87, 87, 87, 87, 88]
プログラム終了

### 28

接続可能な機器:
USB0::6833::1100::DHO9A270600106::0::INSTR
接続した機器: USBInstrument at USB0::6833::1100::DHO9A270600106::0::INSTR
機器ID: RIGOL TECHNOLOGIES,DHO914,DHO9A270600106,00.01.03

測定完了確認: 0

データ点数: 1000
X increment: 1e-07, X origin: -5e-05, X reference: 0.0
Y increment: 0.017067, Y origin: 0.0, Y reference: 128.0
プログラム終了


### 30

小数点以下2桁: ../data/test_30_1.txt に保存
  最初の3行:
  0.00	0.00
  0.06	0.06
  0.13	0.13

カンマ区切り: ../data/test_30_2.txt に保存
  最初の3行:
  0.00000, 0.00000
  0.06283, 0.06279
  0.12566, 0.12533

y, x の順序: ../data/test_30_3.txt に保存
  最初の3行:
  0.00000	0.00000
  0.06279	0.06283
  0.12533	0.12566



### 31

通常の小数点表示: ../data/normal_format.txt に保存
  最初の3行:
  0.00000	0.00000
  0.06283	0.06279
  0.12566	0.12533

指数表記: ../data/scientific_format.txt に保存
  最初の3行:
  0.000e+00	0.000e+00
  6.283e-02	6.279e-02
  1.257e-01	1.253e-01

固定幅表示: ../data/fixed_width_format.txt に保存
  最初の3行:
     0.00000	   0.00000
     0.06283	   0.06279
     0.12566	   0.12533

符号付き表示: ../data/sign_format.txt に保存
  最初の3行:
  +0.00000	+0.00000
  +0.06283	+0.06279
  +0.12566	+0.12533

パーセント表示: ../data/percentage_format.txt に保存
  最初の3行:
  0.00%	0.00%
  6.28%	6.28%
  12.57%	12.53%

=== formatメソッドの説明 ===
基本形式: {インデックス:書式指定}
例:
  {0:.5f} - 0番目の引数を小数点以下5桁で表示
  {0:.3e} - 0番目の引数を指数表記（小数点以下3桁）で表示
  {0:10.5f} - 0番目の引数を全体幅10文字、小数点以下5桁で表示
  {0:+.5f} - 0番目の引数を符号付きで表示
  {0:.2%} - 0番目の引数をパーセント表示（小数点以下2桁）

### 33
最大電圧: 0.7168 V
最小電圧: -0.7339 V
振幅: 0.7253 V
オフセット: -0.0085 V
ピーク・ツー・ピーク: 1.4507 V
平均電圧: -0.0092 V

### 34

振幅: 0.7253 V
周波数: 44871.34 Hz
周期: 0.0223 ms
オフセット: -0.0085 V
最大電圧: 0.7168 V
最小電圧: -0.7339 V
ピーク・ツー・ピーク: 1.4507 V
実効値(RMS): 0.5029 V

###35 
 
測定 1 の準備ができたらEnterキーを押してください...
測定結果 1:
  振幅: 2.0480 V
  周波数: 227626.85 Hz
  周期: 0.0044 ms
  オフセット: 0.0000 V
  ピーク・ツー・ピーク: 4.0961 V

--- 測定 2 ---
測定 2 の準備ができたらEnterキーを押してください...
測定結果 2:
  振幅: 15.5310 V
  周波数: 311.39 Hz
  周期: 3.2114 ms
  オフセット: 0.0000 V
  ピーク・ツー・ピーク: 31.0619 V

--- 測定 3 ---
測定 3 の準備ができたらEnterキーを押してください...
測定結果 3:
  振幅: 3.3621 V
  周波数: 2879.77 Hz
  周期: 0.3472 ms
  オフセット: -0.0171 V
  ピーク・ツー・ピーク: 6.7242 V

### 36
=== ノイズ対策を含む波形解析 ===
振幅の計算結果:
  生データ: 0.7253 V
  フィルタ後: 0.7185 V
  パーセンタイル法: 0.7083 V

オフセットの計算結果:
  平均値: -0.0089 V
  中央値: -0.0085 V
  フィルタ後平均: -0.0089 V

実効値の計算結果:
  生データ: 0.5040 V
  フィルタ後: 0.5035 V

ノイズ解析:
  推定ノイズレベル: 0.023339 V
  推定S/N比: 30.8

### 37
=== フーリエ変換による波形解析 ===
周波数領域解析結果:
  基本周波数: 280.00 Hz
  基本波振幅: 2.5806 V
  位相: -1.54 rad (-88.1 deg)
  DCオフセット: -0.0272 V

検出された高調波:
  2次高調波: 560.00 Hz, 振幅: 0.0950 V (3.7%)
  3次高調波: 840.00 Hz, 振幅: 0.0533 V (2.1%)
  4次高調波: 1120.00 Hz, 振幅: 0.0386 V (1.5%)
  5次高調波: 1400.00 Hz, 振幅: 0.0294 V (1.1%)

時間領域解析結果（比較用）:
  振幅: 3.3792 V
  推定周波数: データ不足のため計算困難

### 39
=== 測定結果の解析 ===
測定回数: 30
平均誤差: 0.01 cm
最大誤差: 0.97 cm
最小誤差: -0.54 cm
誤差の標準偏差: 0.43 cm
測定範囲: 1.0 - 15.0 cm

### 41

=== 測定手順 ===
1. オシロスコープのCH2をGPIO24(Echo)に接続
2. プローブのGNDをブレッドボードのGNDに接続
3. オシロスコープの設定:
   - CH2をアクティブに設定
   - 時間軸と電圧軸を適切に設定してください
   - 推奨設定: 時間軸 100μs/div、電圧軸 1V/div
   - トリガー: AUTO または NORMAL
   - Echo信号が見えるように調整してください

=== 現在のオシロスコープ設定 ===
時間軸: 20000.0 μs/div
CH2電圧軸: 0.100 V/div
CH2オフセット: -0.100 V

設定確認・調整完了後、Enterキーを押してください...
距離測定を実行中...
測定距離: 160.4 mm
データ点数: 1000
時間分解能: 1.00 μs/point

=== Echo信号の解析 ===
検出された電圧範囲: -29.113V ～ -28.761V
自動設定閾値: -28.937V
Echo信号開始時刻: 1.0 μs
Echo信号終了時刻: 75.0 μs
Echo信号持続時間: 74.0 μs
計算距離: 1.3 cm
センサー測定値: 16.0 cm
誤差: 14.8 cm

### 42
=== 最終結果（閾値 0.1V） ===
Echo信号持続時間 τ: 980.00 μs


### 43

=== 複数距離での測定 ===
異なる距離で測定を行い、計算式の精度を確認します
各測定でEnterキーを押してください（終了: q）

測定 1: 実際の距離をcmで入力（終了: q）: 1
測定中...
実際の距離: 1.0 cm
センサー測定値: 2.0 cm
Echo持続時間: 100.0 μs
計算距離:
  v=340m/s: 1.7 cm
  v=343m/s: 1.7 cm
  v=331m/s: 1.7 cm

測定 2: 実際の距離をcmで入力（終了: q）: 3
測定中...
実際の距離: 3.0 cm
センサー測定値: 4.2 cm
Echo持続時間: 240.0 μs
計算距離:
  v=340m/s: 4.1 cm
  v=343m/s: 4.1 cm
  v=331m/s: 4.0 cm

測定 3: 実際の距離をcmで入力（終了: q）: 5
測定中...
実際の距離: 5.0 cm
センサー測定値: 5.2 cm
Echo持続時間: 300.0 μs
計算距離:
  v=340m/s: 5.1 cm
  v=343m/s: 5.1 cm
  v=331m/s: 5.0 cm

測定 4: 実際の距離をcmで入力（終了: q）: 7
測定中...
実際の距離: 7.0 cm
センサー測定値: 8.5 cm
Echo持続時間: 480.0 μs
計算距離:
  v=340m/s: 8.2 cm
  v=343m/s: 8.2 cm
  v=331m/s: 7.9 cm

測定 5: 実際の距離をcmで入力（終了: q）: 9
測定中...
実際の距離: 9.0 cm
センサー測定値: 9.2 cm
Echo持続時間: 530.0 μs
計算距離:
  v=340m/s: 9.0 cm
  v=343m/s: 9.1 cm
  v=331m/s: 8.8 cm

測定 6: 実際の距離をcmで入力（終了: q）: 11
測定中...
実際の距離: 11.0 cm
センサー測定値: 11.6 cm
Echo持続時間: 670.0 μs
計算距離:
  v=340m/s: 11.4 cm
  v=343m/s: 11.5 cm
  v=331m/s: 11.1 cm

測定 7: 実際の距離をcmで入力（終了: q）: 13
測定中...
実際の距離: 13.0 cm
センサー測定値: 14.6 cm
Echo持続時間: 810.0 μs
計算距離:
  v=340m/s: 13.8 cm
  v=343m/s: 13.9 cm
  v=331m/s: 13.4 cm

測定 8: 実際の距離をcmで入力（終了: q）: 15
測定中...
実際の距離: 15.0 cm
センサー測定値: 16.0 cm
Echo持続時間: 920.0 μs
計算距離:
  v=340m/s: 15.6 cm
  v=343m/s: 15.8 cm
  v=331m/s: 15.2 cm

測定 9: 実際の距離をcmで入力（終了: q）: q

=== 測定結果の解析 ===
測定回数: 8
センサー平均誤差: 0.92 cm
v=340m/s 平均誤差: 0.61 cm
v=343m/s 平均誤差: 0.68 cm
v=331m/s 平均誤差: 0.44 cm

最適な音速: 331 m/s (総誤差: 3.55 cm)

結果を ../data/distance_formula_verification.txt に保存しました

=== 結論 ===
距離計算式 d = τv/2 の検証結果:
✓ 式は高精度で有効（平均誤差 < 1cm）
推奨音速: 331 m/s
注意: 温度、湿度、気圧により音速は変化します
プログラム終了

### 46 
=== 課題46: タクトスイッチの長押し時間測定 ===
タクトスイッチの長押し時間を測定します

=== 回路構成 ===
- タクトスイッチの一端: GPIO22
- タクトスイッチの他端: GND
- 内蔵プルアップ抵抗を使用

=== 使用方法 ===
- ボタンを押してから離すまでの時間を測定
- 複数回測定可能
- 終了するにはCtrl+Cを押す

回路の準備ができたらEnterキーを押してください...

--- 測定 1 ---
ボタンを押してください...
ボタンが押されました。離すまでの時間を測定中...
押下時間: 1.421秒 (1421.2ms)
→ 長押し
次の測定の準備中... （少し待ってからボタンを押してください）

--- 測定 2 ---
ボタンを押してください...
ボタンが押されました。離すまでの時間を測定中...
押下時間: 0.125秒 (124.7ms)
→ 中押し
次の測定の準備中... （少し待ってからボタンを押してください）

--- 測定 3 ---
ボタンを押してください...
ボタンが押されました。離すまでの時間を測定中...
押下時間: 2.257秒 (2257.0ms)
→ 長押し
次の測定の準備中... （少し待ってからボタンを押してください）

--- 測定 4 ---
ボタンを押してください...

測定を終了しました。総測定回数: 3

=== 別のアプローチ（ポーリング方式）===
連続的にボタンの状態をチェックする方法でも実装してみます
Enterキーを押すとポーリング方式でのテストを開始します...
ボタンを押してください（ポーリング方式）...
ボタンが押されました（ポーリング検出）
押下時間（ポーリング）: 1.592秒
次の測定まで2秒待機...
ボタンを押してください（2/3回目）...
ボタンが押されました（ポーリング検出）
押下時間（ポーリング）: 1.659秒
次の測定まで2秒待機...
ボタンを押してください（3/3回目）...
ボタンが押されました（ポーリング検出）
押下時間（ポーリング）: 0.417秒
次の測定まで2秒待機...

=== イベント駆動方式の実装 ===
コールバック関数を使用した高精度測定
イベント駆動方式での測定を開始します（10秒間）
ボタンを何度か押してください...
ボタン押下開始（イベント検出）
ボタン押下終了: 0.096秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.103秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.051秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.131秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.182秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.079秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.099秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.103秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.105秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.135秒
ボタン押下開始（イベント検出）
ボタン押下終了: 0.000秒

イベント駆動方式での測定結果:
総測定回数: 11
平均押下時間: 0.099秒
最短押下時間: 0.000秒
最長押下時間: 0.182秒

全測定結果:
   1: 0.096秒
   2: 0.103秒
   3: 0.051秒
   4: 0.131秒
   5: 0.182秒
   6: 0.079秒
   7: 0.099秒
   8: 0.103秒
   9: 0.105秒
  10: 0.135秒
  11: 0.000秒

=== 3つの方式の比較 ===
1. wait_for_press/release方式:
   - 簡単に実装できる
   - ブロッキング動作
   - 他の処理と並行できない

2. ポーリング方式:
   - 状態を連続的にチェック
   - CPU使用率が高い
   - チェック間隔により精度が決まる

3. イベント駆動方式:
   - 最も高精度
   - CPU効率が良い
   - 他の処理と並行可能
   - 複雑な処理に適している
プログラム終了
